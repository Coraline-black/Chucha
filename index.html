<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ò–ò –†–æ–±–æ—Ç</title>
<style>
body {
  background: radial-gradient(circle at top, #2a0f1f, #07030a);
  font-family: Arial, sans-serif;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  height: 100vh;
  margin: 0;
  padding-top: 40px;
  color: white;
}

#robot { width: 260px; text-align: center; position: relative; }

#face {
  width: 190px; height: 190px; background: #140610;
  border-radius: 50% 50% 55% 55%; margin: 0 auto;
  position: relative; box-shadow: 0 0 30px rgba(255,160,200,0.25);
}

.eye {
  width: 44px; height: 44px; background: radial-gradient(circle, #ffd6eb, #ff8fc6);
  border-radius: 50%; position: absolute; top: 55px; transition: height 0.15s;
  box-shadow: 0 0 14px rgba(255,150,200,0.9);
}
.eye.left { left: 45px; }
.eye.right { right: 45px; }
.eye::after {
  content: ""; width: 12px; height: 12px; background: white;
  border-radius: 50%; position: absolute; top: 6px; left: 7px;
}

.smile {
  width: 90px; height: 45px;
  border-bottom: 4px solid #ff9acb;
  border-radius: 0 0 60px 60px;
  position: absolute; bottom: 35px; left: 50%; transform: translateX(-50%);
}

.arm {
  width: 22px; height: 75px; background: #140610;
  position: absolute; top: 110px; border-radius: 20px;
  transform-origin: top center; transition: transform 0.3s;
}
.arm.left { left: -22px; }
.arm.right { right: -22px; }

#card {
  margin-top: 200px; padding: 14px;
  background: rgba(40,10,30,0.9); border-radius: 16px;
  box-shadow: 0 0 15px rgba(255,150,200,0.25);
  min-height: 48px; font-weight: bold;
}

#micBtn {
  margin-top: 16px; padding: 10px 18px;
  background: linear-gradient(135deg, #ff9acb, #ff5fa2);
  border: none; border-radius: 25px; color: white; font-size: 16px;
  cursor: pointer;
}
#micBtn:hover { opacity: 0.9; }
</style>
</head>
<body>

<div id="robot">
  <div id="face">
    <div class="eye left"></div>
    <div class="eye right"></div>
    <div class="smile"></div>
  </div>
  <div id="card">–ù–∞–∂–º–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω –∏ —Å–∫–∞–∂–∏ —á—Ç–æ-–Ω–∏–±—É–¥—å üé§</div>
  <button id="micBtn">üé§ –ì–æ–≤–æ—Ä—é</button>
</div>

<script>
const card = document.getElementById("card");
const micBtn = document.getElementById("micBtn");
const eyes = document.querySelectorAll(".eye");
const leftArm = document.querySelector(".arm.left");
const rightArm = document.querySelector(".arm.right");

/* –ú–æ—Ä–≥–∞–Ω–∏–µ –≥–ª–∞–∑ */
setInterval(() => {
  eyes.forEach(e => e.style.height = "6px");
  setTimeout(() => {
    eyes.forEach(e => e.style.height = "44px");
  }, 180);
}, 2500);

/* –ñ–µ—Å—Ç —Ä—É–∫–∞–º–∏ */
function gesture() {
  rightArm.style.transform = "rotate(25deg)";
  leftArm.style.transform = "rotate(-15deg)";
  setTimeout(() => {
    rightArm.style.transform = "rotate(0deg)";
    leftArm.style.transform = "rotate(0deg)";
  }, 500);
}

/* –û—Ç–≤–µ—Ç –Ω–∞ –∫–∞—Ä—Ç–æ–Ω–∫–µ */
function respond(text) {
  card.textContent = text;
  gesture();
}

/* –ü—Ä–æ–≤–µ—Ä–∫–∞, –Ω—É–∂–Ω–æ –ª–∏ –æ—Ç–≤–µ—á–∞—Ç—å */
function shouldRespond(text) {
  // –ü—Ä–∏–º–µ—Ä—ã –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤: –µ—Å–ª–∏ –∏–≥—Ä–æ–∫ –¥–∞–ª –ø—Ä–∏–º–µ—Ä –∏–ª–∏ –ø–æ–ø—Ä–æ—Å–∏–ª —á—Ç–æ-—Ç–æ
  const triggers = ["–ø–æ–∫–∞–∂–∏", "—Å–∫–æ–ª—å–∫–æ", "–≤—ã—á–∏—Å–ª–∏", "–ø—Ä–∏–º–µ—Ä", "—Ä–µ—à–∏"];
  return triggers.some(word => text.includes(word));
}

/* üé§ –ì–æ–ª–æ—Å */
micBtn.onclick = () => {
  if (!("webkitSpeechRecognition" in window)) {
    respond("–ì–æ–ª–æ—Å –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è üò¢");
    return;
  }

  const recognition = new webkitSpeechRecognition();
  recognition.lang = "ru-RU";
  recognition.start();
  respond("–Ø —Å–ª—É—à–∞—é —Ç–µ–±—è‚Ä¶ üéß");

  recognition.onresult = async (event) => {
    const text = event.results[0][0].transcript.toLowerCase();
    
    if (!shouldRespond(text)) {
      // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º, –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–æ –æ—Ç–≤–µ—á–∞—Ç—å
      card.textContent = "üí≠ –ü–æ–∫–∞ –º–æ–ª—á—É...";
      return;
    }

    respond("–î—É–º–∞—é‚Ä¶ üí≠");

    // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –ò–ò —á–µ—Ä–µ–∑ OpenAI
    // –ù–∏–∂–µ –ø—Ä–∏–º–µ—Ä –±–µ–∑ –ò–ò, –ø—Ä–æ—Å—Ç–æ —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä
    // –ü—Ä–æ—Å—Ç–æ–π —Ä–∞–∑–±–æ—Ä —á–∏—Å–µ–ª –∏ –¥–µ–π—Å—Ç–≤–∏–π
    let answer = "";
    try {
      // –ü—Ä–æ–±—É–µ–º –≤—ã—á–∏—Å–ª–∏—Ç—å –ø—Ä–∏–º–µ—Ä –≤ –≤–∏–¥–µ "2 + 2"
      const match = text.match(/(\d+)\s*([+\-*/])\s*(\d+)/);
      if (match) {
        const a = parseInt(match[1]);
        const op = match[2];
        const b = parseInt(match[3]);
        switch(op) {
          case "+": answer = a + b; break;
          case "-": answer = a - b; break;
          case "*": answer = a * b; break;
          case "/": answer = (b!==0)? a/b : "‚àû"; break;
        }
        respond(`–û—Ç–≤–µ—Ç: ${answer}`);
      } else {
        respond("–•–º–º‚Ä¶ –ø–æ–∫–∞ –Ω–µ –∑–Ω–∞—é, –Ω–æ —É—á—É—Å—å üí≠");
      }
    } catch(e) {
      respond("–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ üí•");
    }
  };
};
</script>

</body>
</html>
